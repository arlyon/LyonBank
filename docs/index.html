<html>
<head>
    <meta charset="utf-8">
    <title>Lyon Banking Contract</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://fonts.googleapis.com/css?family=Nunito:400,700" rel="stylesheet">
    <link rel="stylesheet" href="./css/normalize.css">
    <link rel="stylesheet" href="./css/main.css">
    <link rel="stylesheet" href="./css/hljs.css">
</head>
<body>
<header>
    <div>The Lyon Banking Contract</div>
</header>
<div class="centered">
    <h1>An Introduction to Ethereum</h1>
    <h3>A decentralized and anonymous new crypto-platform.</h3>
    <p>The ethereum platform is, shortly, a distributed computing network that creates and manages a
        indisputable ledger of transactions. Additionally it provides some functionality that allows
        programs to be compiled and run on the network, by the computers hosting the network. Making
        transactions requires ether, the native currency on the platform. Like a car, the ethereum
        platform runs on gas and ether is the fuel.
    </p>
    <p>Ethereum uses <a
        href="https://github.com/ethereumbuilders/ethereum101/wiki/Public-Key-Cryptography">public-key
        cryptography</a> (it is a crypto-coin after all) that works very
        similarly to message encryption. In public key crypto a user shares their public key and others use it to
        encrypt the message. Now that it has been encrypted with the public key, the only way to get
        anything meaningful out of the encrypted message is to decrypt it with the private key. The
        ethereum platform works in a similar manner. When an account is generated, an algorithm
        spits out a random public key and its corresponding private key. Only the owner of the
        private key can make any transactions on the behalf of the account. This includes sending
        ether, which means that we have uncovered a glaring vulnerability.
    </p>
</div>
<div class="centered">
    <h1>The Current Security Landscape</h1>
    <h3>A central and catastrophic point of failure.</h3>
    <p>In its current form, ethereum wallets have a single point of failure. Anyone with access to a
        wallet's private key has full control over all the funds in that account meaning any
        security breach is catastrophic and irreversible (ie. any security breach is a complete security breach - the idea
        of a partial breach is foreign to a system where a single key means control). There are multiple methods that we can use
        to mitigate these problems, all of which share the same shortcoming. One of
        the most common alternatives is splitting your funds into hot-and-cold wallets. Acting
        similarly to a checking-and-savings account, a cold wallet stores the majority of your
        assets, letting you manage them from an offline or air-gapped wallet to ensure isolation
        from malicious software. The primary ideology here is that if your "hot" wallet, or checking
        account were compromised, your "cold" wallet, or savings account would remain safe.
        This method still has a central point of failure. If a key is compromised (or lost)
        funds are irreversibly gone. If you save the key in only one place, you risk losing the key
        (ex. from a fire); the only way to counter this is to save the key in multiple places which
        opens up another vulnerability: theft, physical or electronic.
    </p>
    <p>To patch this vulnerability, we need to devise a solution that guarantees that a security failure
        is not a total failure, implementing a series of failsafes that ensure that the account only holds
        value for the account owner, and that any potential attacker would derive no benefit from stealing the private key.
        Luckily, as mentioned briefly in the introduction - and because ethereum is a computing platform
        rather than just another block chain crypto-currency - we can create a solution that
        completely absolves the risk of losing a key. This revolves around a class-like
        structure on the ethereum block chain: the smart contract. The public and immutable ledger
        that ethereum is built on ensures that any code uploaded to it (and irreversibly fused with it)
        operates exactly as defined at inception, completely resistent to modification.
        This contract then exists on the decentralized network, ready to be engaged by anyone,
        and benefited from by everyone.
    </p>
</div>

<div class="centered">
    <h1>The Lyon Banking Contract</h1>
    <h3>A safe banking method to store the ethereum of multiple users.</h3>
    <p>Smart contracts have all the rights of a regular account, but are controlled by code. This
        means that they may hold and spend ether, just like a regular account. Additionally, a
        standard known as <a href="https://github.com/ethereum/EIPs/issues/20">ERC-20</a> has
        defined "tokens" or "coins" that exist as sub-currency on the platformm. These can
        be created by any contract, and the contract needs only support a small set of functions to
        make it ERC-20 compliant. Using a combination of the contracts' account-like properties,
        some unique functionality, and our own token, we can safely trade ether with the contract, and
        in return receive tokens that have no value to malicious parties but can be traded back in
        for the original deposit.
    </p>
    <p>The system relies on three separate layers, outlined below.
    </p>
</div>

<div id="infographic">
    <div id="management" class="shifted front">
        <div class="centered columns">
            <div>
                <h2>Managers</h2>
                <p>
                    Two trusted addresses are assigned the role of managing the withdrawals. Any
                    attempts to cash in tokens will then need to be approved manually.
                </p>
                <p>
                    The third address is safely stored such that both managers must be present to
                    access it. This means that a compromised manager can be replaced with a new,
                    (secure) address with zero asset loss.
                </p>
            </div>
                <img src="img/management.svg"/>
        </div>
    </div>
    <div id="transactions" class="shifted">
        <div class="centered columns">
            <div>
                <h2>Transactions</h2>
                <p>
                    A withdrawal request is made, and upon confirmation the ether is deposited back
                    into the owner's account and the equivalent tokens retracted. Any transaction
                    is cancellable.
                </p>

            </div>
            <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 478 499" class="double">
                <defs>
                    <style>
                        .cls-1{isolation:isolate;}
                        .cls-2{opacity:0.4;mix-blend-mode:multiply;}
                        .cls-11, .cls-3{fill:#fff;}
                        .cls-4{font-size:42px;fill:#111;}
                        .cls-11,.cls-4{font-family:"Nunito-Regular","Nunito";}
                        .cls-5{letter-spacing:-0.004em;}
                        .cls-6{letter-spacing:-0.009em;}
                        .cls-7,.cls-8,.cls-9{fill:#39bca3;}
                        .cls-8{letter-spacing:-0.003em;}
                        .cls-9{letter-spacing:0em;}
                        .cls-10{fill:url(#linear-gradient);}
                        .cls-11{font-size:40px;}
                        .cls-12{fill:url(#linear-gradient-2);}
                        .cls-13{fill:url(#linear-gradient-3);}
                        .cls-14{fill:url(#linear-gradient-4);}
                    </style>
                    <linearGradient id="linear-gradient" x1="62" y1="27" x2="62" y2="91" gradientUnits="userSpaceOnUse">
                        <stop offset="0" stop-color="#3fa1ff"/>
                        <stop offset="1" stop-color="#8c7fff"/>
                    </linearGradient>
                    <linearGradient id="linear-gradient-2" x1="62" y1="154" x2="62" y2="218" gradientUnits="userSpaceOnUse">
                        <stop offset="0" stop-color="#ffdc7f"/>
                        <stop offset="1" stop-color="#ff6afb"/>
                    </linearGradient>
                    <linearGradient id="linear-gradient-3" x1="62" y1="281" x2="62" y2="345" gradientUnits="userSpaceOnUse">
                        <stop offset="0" stop-color="#ddffd4"/>
                        <stop offset="1" stop-color="#3fffcc"/>
                    </linearGradient>
                    <linearGradient id="linear-gradient-4" x1="62" y1="408" x2="62" y2="472" gradientUnits="userSpaceOnUse">
                        <stop offset="0" stop-color="#fff1bf"/>
                        <stop offset="1" stop-color="#ff4f3f"/>
                    </linearGradient>
                    <image id="image" width="478" height="118"
                           xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAd4AAAB2CAYAAABmpvL0AAAACXBIWXMAAAsSAAALEgHS3X78AAAEt0lEQVR4Xu3aIY5USxTH4ZqZwABBIAgEJAKFQsATsIRZAIoO7II1jEfALthAG3iOHaAIEkcw5GXe+c+9QPfcJhNCOOoTn+hO3bK/nKoaJycnAwDosfvPMfZm+wDAbzvt6LnhHT9je1AulMNyqVwGAM6VZqadaWhaehrhneEdU3Sz6GK5Uq6V6+VmuVVuAwC/lFammWlnGpqWpqlp696u8O7PC66WG+VOuVfulwflYfkHAFhII9PKNDPtTEPT0jQ1bd3fCu/4Oe1emRfeLY/KUXlSnpZn5TkAsJBGppVpZtqZhqalaWraejDmqXczvClyRuNU+nFZlRfluLwsr8prAGAhjUwr08y0czWmlqapaWsauxXeHDPnMjjn0hmRj+YPs9Gbsi7vyr8AwEIauR5TM9PONDQtTVPT1sMxHzdvhjcvsXIpnPPpjMrH8wbvy4fysXwCABbSyLQyzUw709C0NE1NW9PYRXjzDDovsnI5vBrTyLyeN/pcvpSvAMBCGplWppnrMTV0Naampq1p7M7w5jl0Xmflkjij8tsxVTwbfiv/AQALaWRamWamnWloWpqmpq3nhjcvtHJZnHPrjNBf541PAICFNDKtTDPTzjQ0LRVeAPgLhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAI+EFgEbCCwCNhBcAGgkvADQSXgBoJLwA0Eh4AaCR8AJAoz8O77PyqrwtH8uX8m3eGADYlkamlWlm2pmGpqXnhvdWeVBW5WVZlw/l87zhVwBgIY1MK9PM9ZgauhpTU9PWneG9VG6W++VJOS5vyvt5o1T8EwCwkEamlWlm2pmGpqVpatqaxi7Ce1iul3vlqLwY06icDdbl3ZjOrQGAbWnkekzNTDvT0LQ0TU1bD8eZ8O6Vi+VauVMej2lEzoep9st5o9cAwEIamVammWnnakwtTVPT1jR272x4D8qVcqPcLY/GVOuMyk/HdEn8HABYSCPTyjQz7UxD09I0NW09GJvh3ThuTpGvzgtT6YzIOZ/O5fDDMb3OAgC2pZFpZZqZdqahaWmamrbu/+jtRni/T71ZkDpnNM65dC6F8yLrNgDwS2llmpl2pqFpaZr6Y9rdCu9GfPfnRRfGdBmcl1iXAYBzpZlpZxqalqape1ut3fxxJsDfIwwA/J7Tju5s7K4/AYC/439rNnzTVGaSZwAAAABJRU5ErkJggg=="/>
                </defs>
                <title>transactions</title>
                <g class="cls-1">
                    <g id="Layer_2" data-name="Layer 2">
                        <g id="Layer_1-2" data-name="Layer 1">
                            <use class="cls-2" xlink:href="#image"/>
                            <rect class="cls-3" x="6" y="4" width="466" height="106"/>
                            <text class="cls-4" transform="translate(108.333 72.333)">Withd
                                <tspan class="cls-5" x="118.564" y="0">r</tspan>
                                <tspan x="133.223" y="0">a</tspan>
                                <tspan class="cls-6" x="155.482" y="0">w</tspan>
                                <tspan x="190.469" y="0">al</tspan>
                                <tspan class="cls-7" x="233.309" y="0">10</tspan>
                                <tspan class="cls-8" x="283.708" y="0">e</tspan>
                                <tspan class="cls-9" x="305.716" y="0">th</tspan>
                            </text>
                            <circle class="cls-10" cx="62" cy="59" r="32"/>
                            <text class="cls-11" transform="translate(47.333 72.333)">A</text>
                            <use class="cls-2" transform="translate(0 127)" xlink:href="#image"/>
                            <rect class="cls-3" x="6" y="131" width="466" height="106"/>
                            <text class="cls-4" transform="translate(108.333 199.333)">Withd
                                <tspan class="cls-5" x="118.564" y="0">r</tspan>
                                <tspan x="133.223" y="0">a</tspan>
                                <tspan class="cls-6" x="155.482" y="0">w</tspan>
                                <tspan x="190.469" y="0" xml:space="preserve">al   </tspan>
                                <tspan class="cls-7" x="254.98" y="0">9</tspan>
                                <tspan class="cls-8" x="280.18" y="0">e</tspan>
                                <tspan class="cls-7" x="302.188" y="0">th</tspan>
                            </text>
                            <circle class="cls-12" cx="62" cy="186" r="32"/>
                            <text class="cls-11" transform="translate(47.333 199.333)">C</text>
                            <use class="cls-2" transform="translate(0 254)" xlink:href="#image"/>
                            <rect class="cls-3" x="6" y="258" width="466" height="106"/>
                            <text class="cls-4" transform="translate(108.333 326.333)">Withd
                                <tspan class="cls-5" x="118.564" y="0">r</tspan>
                                <tspan x="133.223" y="0">a</tspan>
                                <tspan class="cls-6" x="155.482" y="0">w</tspan>
                                <tspan x="190.469" y="0">al</tspan>
                                <tspan class="cls-7" x="233.309" y="0">11</tspan>
                                <tspan class="cls-8" x="283.708" y="0">e</tspan>
                                <tspan class="cls-9" x="305.716" y="0">th</tspan>
                            </text>
                            <circle class="cls-13" cx="62" cy="313" r="32"/>
                            <text class="cls-11" transform="translate(47.333 326.333)">B</text>
                            <use class="cls-2" transform="translate(0 381)" xlink:href="#image"/>
                            <rect class="cls-3" x="6" y="385" width="466" height="106"/>
                            <text class="cls-4" transform="translate(108.333 453.333)">Withd
                                <tspan class="cls-5" x="118.564" y="0">r</tspan>
                                <tspan x="133.223" y="0">a</tspan>
                                <tspan class="cls-6" x="155.482" y="0">w</tspan>
                                <tspan x="190.469" y="0" xml:space="preserve">al   </tspan>
                                <tspan class="cls-7" x="254.98" y="0">2</tspan>
                                <tspan class="cls-8" x="280.18" y="0">e</tspan>
                                <tspan class="cls-7" x="302.188" y="0">th</tspan>
                            </text>
                            <circle class="cls-14" cx="62" cy="440" r="32"/>
                            <text class="cls-11" transform="translate(47.333 453.333)">A</text>
                        </g>
                    </g>
                </g>
            </svg>
        </div>
    </div>
    <div id="users" class="shifted front">
        <div class="centered columns">
            <div>
                <h2>Users</h2>
                <p>
                    Funds are deposited into the bank in return for tokens. These cannot be
                    cashed in or traded without approval from the managers, meaning the tokens
                    are theft resistant.
                </p>
                <p>
                    The tokens mean that if a user were to lose their address, their cold funds are
                    safe inside the bank and the tokens can be transferred easily to a new address.
                </p>

            </div>
                <img src="img/users.svg"/>
        </div>
    </div>
</div>

<div class="centered">
    <h1>Problems Solved</h1>
    <h3>Communication between the decentralized and the centralized.</h3>
    <p>
        Requiring manual approval from a trusted party resolves a few issues but also presents new ones.
        Here is how they are solved.
    </p>
    <h2>When a User's Account is Compromised</h2>
    <p>
        When a user experiences an account breach, all the funds in their account are locked unless consent is given
        by the managers. This means that the account holder can speak with the bank managers and
        initiate a token transaction to a secure wallet, and have the correct transaction - to the new, safe, address -
        confirmed by the managers.
    </p>
    <ul class="cards">
        <li>
            <header>transfer(address _to, uint256 _value)</header>
            The compromised account initiates a transfer of their tokens to a new account and informs the admins of the
            situation.
        </li>
        <li>
            <header>approveTransaction(uint transactionId)</header>
            The managers, knowing which account the funds should be transferred into, approve the transfer. When enough
            managers register their approval, the transfer executes and the tokens change owner.
        </li>
    </ul>
    <h2>When a Manager's Account is Compromised</h2>
    <p>Managers are essentially users with additional priveleges, meaning the process is similar for both. First,
        transfer assets to the new wallet and then initiate a manager change to then be confirmed by the remaining managers.
    </p>
    <ul class="cards">
        <li>
            <header>createManagementVote(address from, address to)</header>
            A management vote is created to be approved by the other manager accounts. In our specific architecture,
            the uncompromised account, along with the owner on the compromised one retrieve the third key and use that
            third key as the second vote to change manager.
        </li>
        <li>
            <header>
                approveManagementVote(uint changeManagerId)
            </header>
            Similar to the transaction vote, <code>approveManagementVote()</code> registers a manager's approval for the
            specified action which, upon reaching the required number of votes, executes and transfers ownership.
        </li>
    </ul>
</div>

<div class="centered">
    <h1>Events</h1>
    <h3>Communication between the decentralized and the centralized.</h3>
    <p>
        The blockchain is a history of blocks which are fundamentally themselves just lists of transactions. Each
        transaction has an attached receipt which contains zero or more log entries. Log entries
        represent the result of events having fired from a smart contract. Events are dispatched
        using signals the smart contracts can fire. Programs off-chain can then listen for these events to stay
        informed about various happenings on-chain.
    </p>
    <h2>
        Account Related
    </h2>
    <ul class="cards">
        <h3>Managers</h3>
        <li>
            <header>CreateManagerChange</header>
            This event is called by the function that changes managers in the event of one of the
            keys getting lost or compromised, an initiates the manager change process.
        </li>
        <li>
            <header>ApproveManagerChange</header>
            This event is called when a manager votes on the manager change.
        </li>
        <li>
            <header>CompleteManagerChange</header>
            This event is called when the managerchange motion receives enough votes and is approved.
        </li>
        <h3>Members</h3>
        <li>
            <header>MemberAdded</header>
            This event is called when a new account is added to the list of members.
        </li>
        <li>
            <header>MemberRemoved</header>
            This event is called when an account is removed from the list of members.
        </li>
    </ul>
    <h2>
        Transaction Related
    </h2>
    <ul class="cards">
        <li>
            <header>CreateTransaction</header>
            This event is called when a withdrawal from the bank is requested.
        </li>
        <li>
            <header>ApproveTransaction</header>
            This event is called when a withdrawal from the bank is confirmed by a manager.
        </li>
        <li>
            <header>CompleteTransaction</header>
            This event is called when a withdrawal from the bank is executed.
        </li>
        <li>
            <header>Deposit</header>
            This event is called when money is successfully deposited into the bank.
        </li>
    </ul>
    <h2>
        Self Distruct
    </h2>
    <p>
        The bank, as a safety measure, may shut down operation immediately refunding all users
        of their deposits and blocking all future transfers rendering it completely inoperable.
        This self distruct - as with all other actions - must be approved by managers first.
    </p>
    <ul class="cards">
        <li>
            <header>SelfDistructVote</header>

        </li>
        <li>
            <header>SelfDistructComplete</header>

        </li>
    </ul>
</div>

<div class="centered">
    <h1>Implementation</h1>
    <h3>The software behind the smart contract.</h3>
    <p>
        With our intentions clearly presented, we are ready to implement it. With an ERC-20 token
        as the basis, we will start by implementing the methods defined in the standard. These are:
    <pre><code>// core functionality
function totalSupply() returns (uint256 totalSupply); // the total number of tokens in circulation
function balanceOf(address owner) returns (uint256 balance); // the balance of a particular address
function transfer(address to, uint256 value) returns (bool success); // transfer a users tokens to another address
// allow other users to take money out on your behalf
function transferFrom(address from, address to, uint256 value) returns (bool success); // transfer from one address to another
function approve(address spender, uint256 value) returns (bool success); // approve an address to withdraw a certain amount
function allowance(address owner, address spender) returns (uint256 remaining); // check how much you can withdraw from another account
        </code></pre>
    </p>
</div>

<div class="centered">
    <h1>Resources</h1>
    <h3>Useful resources.</h3>
    <ul>
        <li><a
            href="https://github.com/ConsenSys/MultiSigWallet/blob/master/contracts/solidity/MultiSigWallet.sol">https://github.com/ConsenSys/MultiSigWallet/blob/master/contracts/solidity/MultiSigWallet.sol</a>
        </li>
        <li><a href="https://github.com/ethereum/dapp-bin/blob/master/wallet/wallet.sol">https://github.com/ethereum/dapp-bin/blob/master/wallet/wallet.sol</a>
        </li>
        <li><a
            href="https://ethereum.stackexchange.com/questions/2940/where-can-i-find-some-solidity-smart-contract-source-code-examples">https://ethereum.stackexchange.com/questions/2940/where-can-i-find-some-solidity-smart-contract-source-code-examples</a>
        </li>
        <li><a href="http://paletton.com/#uid=73c0u0knP-xdROljkGttgvOvuo+">http://paletton.com/#uid=73c0u0knP-xdROljkGttgvOvuo+</a>
        </li>
    </ul>
</div>

<script src="http://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    function hljsDefineSolidity (hljs) {
        var SOL_KEYWORDS = {
            keyword: 'var bool string ' +
            'int uint int8 uint8 int16 uint16 int24 uint24 int32 uint32 ' +
            'int40 uint40 int48 uint48 int56 uint56 int64 uint64 ' +
            'int72 uint72 int80 uint80 int88 uint88 int96 uint96 ' +
            'int104 uint104 int112 uint112 int120 uint120 int128 uint128 ' +
            'int136 uint136 int144 uint144 int152 uint152 int160 uint160 ' +
            'int168 uint168 int176 uint176 int184 uint184 int192 uint192 ' +
            'int200 uint200 int208 uint208 int216 uint216 int224 uint224 ' +
            'int232 uint232 int240 uint240 int248 uint248 int256 uint256 ' +
            'byte bytes bytes1 bytes2 bytes3 bytes4 bytes5 bytes6 bytes7 bytes8 ' +
            'bytes9 bytes10 bytes11 bytes12 bytes13 bytes14 bytes15 bytes16 ' +
            'bytes17 bytes18 bytes19 bytes20 bytes21 bytes22 bytes23 bytes24 ' +
            'bytes25 bytes26 bytes27 bytes28 bytes29 bytes30 bytes31 bytes32 ' +
            'enum struct mapping address ' +

            'new delete ' +
            'if else for while continue break return throw ' +

            'function modifier event ' +
            'constant anonymous indexed ' +
            'storage memory ' +
            'external public internal private returns ' +

            'import using ' +
            'contract library ' +
            'assembly',
            literal: 'true false ' +
            'wei szabo finney ether ' +
            'second seconds minute minutes hour hours day days week weeks year years',
            built_in: 'self ' +   // :NOTE: not a real keyword, but a convention used in storage manipulation libraries
            'this super selfdestruct ' +
            'now ' +
            'msg ' +
            'block ' +
            'tx ' +
            'sha3 sha256 ripemd160 erecover addmod mulmod ' +
            // :NOTE: not really toplevel, but advantageous to have highlighted as if reserved to
            //        avoid newcomers making mistakes due to accidental name collisions.
            'send call callcode delegatecall',
        }

        var SOL_NUMBER = {
            className: 'number',
            variants: [
                {begin: '\\b(0[bB][01]+)'},
                {begin: '\\b(0[oO][0-7]+)'},
                {begin: hljs.C_NUMBER_RE},
            ],
            relevance: 0,
        }

        var SOL_FUNC_PARAMS = {
            className: 'params',
            begin: /\(/, end: /\)/,
            excludeBegin: true,
            excludeEnd: true,
            keywords: SOL_KEYWORDS,
            contains: [
                hljs.C_LINE_COMMENT_MODE,
                hljs.C_BLOCK_COMMENT_MODE,
                hljs.APOS_STRING_MODE,
                hljs.QUOTE_STRING_MODE,
                SOL_NUMBER,
            ],
        }

        var SOL_RESERVED_MEMBERS = {
            begin: /\.\s*/,  // match any property access up to start of prop
            end: /[^A-Za-z0-9$_\.]/,
            excludeBegin: true,
            excludeEnd: true,
            keywords: {
                built_in: 'gas value send call callcode delegatecall balance length push',
            },
            relevance: 2,
        }

        function makeBuiltinProps (obj, props) {
            return {
                begin: obj + '\\.\\s*',
                end: /[^A-Za-z0-9$_\.]/,
                excludeBegin: false,
                excludeEnd: true,
                keywords: {
                    built_in: obj + ' ' + props,
                },
                contains: [
                    SOL_RESERVED_MEMBERS,
                ],
                relevance: 10,
            }
        }

        return {
            aliases: ['sol'],
            keywords: SOL_KEYWORDS,
            contains: [
                // basic literal definitions
                hljs.APOS_STRING_MODE,
                hljs.QUOTE_STRING_MODE,
                hljs.C_LINE_COMMENT_MODE,
                hljs.C_BLOCK_COMMENT_MODE,
                SOL_NUMBER,
                { // functions
                    className: 'function',
                    beginKeywords: 'function modifier event', end: /[{;]/, excludeEnd: true,
                    contains: [
                        hljs.inherit(hljs.TITLE_MODE, {
                            begin: /[A-Za-z$_][0-9A-Za-z$_]*/,
                            keywords: SOL_KEYWORDS,
                        }),
                        SOL_FUNC_PARAMS,
                    ],
                    illegal: /\[|%/,
                },
                // built-in members
                makeBuiltinProps('msg', 'data sender sig'),
                makeBuiltinProps('block', 'blockhash coinbase difficulty gaslimit number timestamp '),
                makeBuiltinProps('tx', 'gasprice origin'),
                SOL_RESERVED_MEMBERS,
                { // contracts & libraries
                    className: 'class',
                    beginKeywords: 'contract library', end: /[{]/, excludeEnd: true,
                    illegal: /[:"\[\]]/,
                    contains: [
                        {beginKeywords: 'is'},
                        hljs.UNDERSCORE_TITLE_MODE,
                        SOL_FUNC_PARAMS,
                    ],
                },
                { // imports
                    beginKeywords: 'import', end: '[;$]',
                    keywords: 'import * from as',
                    contains: [
                        hljs.APOS_STRING_MODE,
                        hljs.QUOTE_STRING_MODE,
                    ],
                },
            ],
            illegal: /#/,
        }
    }

    hljs.registerLanguage('solidity', hljsDefineSolidity);
    hljs.initHighlightingOnLoad();
</script>
</body>
</html>
